      LEFT, RIGHT

select right(website, 3), count(*)
from accounts
group by 1

select left(upper(name), 1), count(*)
from accounts
group by 1
order by 2 desc

SELECT
    CASE
        WHEN LEFT(name, 1) IN ('1','2','3','4','5','6','7','8','9','0') THEN 'number'
        ELSE 'letter'
    END,
count(*)
FROM accounts
group by 1

select sum(vowels) vowels, sum(no_vowels) no_vowels
from    
  (select
    CASE
        WHEN LEFT(upper(name), 1) IN ('A','E','I','O','U') THEN 1
        ELSE 0 END as vowels,
    CASE
        WHEN LEFT(upper(name), 1) IN ('A','E','I','O','U') THEN 0
        ELSE 1 END as no_vowels
FROM accounts) t1

      POSITION & STRPOS

select left(primary_poc, position(' ' in primary_poc) - 1) first_name,
       right(primary_poc, (length(primary_poc) - position(' ' in primary_poc))) last_name
from accounts

      CONCAT

WITH names as (
select name, 
      left(primary_poc, position(' ' in primary_poc) - 1) first_name,
      right(primary_poc, (length(primary_poc) - position(' ' in primary_poc))) last_name
from accounts
)                          
select first_name, last_name,
   concat(first_name, '.', last_name, '@', name, '.com')
from names   

WITH names as (
select name, 
      left(primary_poc, position(' ' in primary_poc) - 1) first_name,
      right(primary_poc, (length(primary_poc) - position(' ' in primary_poc))) last_name
from accounts
)                          
select first_name, last_name,
   concat(first_name, '.', last_name, '@', replace(name, ' ', ''), '.com')
from names    

WITH names as (
select name, 
      left(primary_poc, position(' ' in primary_poc) - 1) first_name,
      right(primary_poc, (length(primary_poc) - position(' ' in primary_poc))) last_name
from accounts)
                          
select concat(left(lower(first_name),1), right(first_name,1), left(lower(last_name),1), right(last_name,1), length(first_name), length(last_name), replace(upper(name), ' ', '')) password,
   concat(first_name, '.', last_name, '@', replace(name, ' ', ''), '.com') email
from names  


SELECT date orig_date, (SUBSTR(date, 7, 4) || '-' || LEFT(date, 2) || '-' || SUBSTR(date, 4, 2)):: date new_date
FROM sf_crime_data;


        COALESCE

SELECT COALESCE(o.id, a.id) filled_id, a.name, a.website, a.lat, a.long, a.primary_poc, a.sales_rep_id, COALESCE(o.account_id, a.id) account_id, o.occurred_at, COALESCE(o.standard_qty, 0) standard_qty, COALESCE(o.gloss_qty, 0) gloss_qty, COALESCE(o.poster_qty, 0) poster_qty, COALESCE(o.total, 0) total, COALESCE(o.standard_amt_usd, 0) standard_amt_usd, COALESCE(o.gloss_amt_usd, 0) gloss_amt_usd, COALESCE(o.poster_amt_usd, 0) poster_amt_usd, COALESCE(o.total_amt_usd, 0) total_amt_usd
FROM accounts a
LEFT JOIN orders o
ON a.id = o.account_id
WHERE o.total IS NULL;





