



select a.name, count(o.id)
from orders o
join accounts a
ON o.account_id=a.id
group by 1
ORDER BY 2 desc
limit 1

select a.name, SUM(o.total_amt_usd)
from orders o
join accounts a
ON o.account_id=a.id
group by 1
having SUM(o.total_amt_usd) > 30000

select a.name, SUM(o.total_amt_usd)
from orders o
join accounts a
ON o.account_id=a.id
group by 1
order by 2 desc
limit 1

select a.name, w.channel, count(w.id)
from web_events w
join accounts a
ON w.account_id=a.id
where w.channel = 'facebook'
group by 1,2
having count(w.id) > 6


select a. name, w.channel, count(w.account_id)
from web_events w
join accounts a
ON w.account_id=a.id
group by 1,2
order by 3 desc


select date_trunc('year', occurred_at), sum(total_amt_usd)
from orders
group by 1
order by 1

select date_part('month', occurred_at), sum(total_amt_usd)
from orders
WHERE occurred_at BETWEEN '2014-01-01' AND '2017-01-01'
group by 1
order by 2 desc

select date_part('year', occurred_at), count(id)
from orders
WHERE occurred_at BETWEEN '2014-01-01' AND '2017-01-01'
group by 1
order by 2 desc
limit 1

select date_trunc('month', o.occurred_at), sum(o.gloss_amt_usd)
from orders o
join accounts a
ON a.id=o.account_id
where a.name = 'Walmart'
group by 1
order by 2 desc

