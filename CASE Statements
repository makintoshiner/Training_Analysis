
select account_id, total_amt_usd,
case when total_amt_usd >= 3000 then 'Large'
     else 'Small' end
from orders

select 
case when total >= 2000 then 'At least 2000'
     when total >= 1000 then 'Between 1000 and 2000'
     else 'Less than 1000' end as order_category,
count(*) cnt_orders
from orders
group by 1
order by 1

select a.name, sum(total_amt_usd) total_sales,
case when sum(total_amt_usd) >= 200000 then 'Top'
     when sum(total_amt_usd) >= 100000 then 'Middle'
     else 'low' end as level
from orders o
join accounts a
ON o.account_id=a.id
group by 1
order by 2 desc

select a.name, sum(total_amt_usd) total_sales,
case when sum(total_amt_usd) >= 200000 then 'Top'
     when sum(total_amt_usd) >= 100000 then 'Middle'
     else 'low' end as level
from orders o
join accounts a
ON o.account_id=a.id
where occurred_at between '2016-01-01' and '2018-01-01'
group by 1
order by 2 desc

select s.name, count(o.id) count_sales,
case when count(o.id) >= 200 then 'Top'
     else 'Not' end as level
from orders o
join accounts a
ON o.account_id=a.id
join sales_reps s
ON a.sales_rep_id=s.id
group by 1
order by 2 desc

select s.name, count(o.id) count_sales, sum(total_amt_usd) total_sales,
case when count(o.id) >= 200 or sum(total_amt_usd) >= 750000 then 'Top'
     when count(o.id) >= 150 or sum(total_amt_usd) >= 500000 then 'Middle'
     else 'Low' end as level
from orders o
join accounts a
ON o.account_id=a.id
join sales_reps s
ON a.sales_rep_id=s.id
group by 1
order by 3 desc


